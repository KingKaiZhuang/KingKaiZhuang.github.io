<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Line Bot 與 Openai &amp; SQL 03 - 成績查詢 | FullStackPenguin</title><meta name="author" content="全端企鵝"><meta name="copyright" content="全端企鵝"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="參考來源 : https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;IfzY0axpjD8&amp;t&#x3D;333s 基於 LINE Bot 與 OpenAI 的 MySQL 學生成績管理系統教學文件目錄 前言 系統需求與工具 資料庫設計與結構 插入 15 位學生的資料 為每位學生插入成績 使用 OpenAI 生成 SQL 語句 LINE Bot 與 OpenAI 整合 查詢學生成績 常見問">
<meta property="og:type" content="article">
<meta property="og:title" content="Line Bot 與 Openai &amp; SQL 03 - 成績查詢">
<meta property="og:url" content="https://kingkaizhuang.github.io/2024/10/02/Line-Bot-%E8%88%87-Openai-SQL-%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2/index.html">
<meta property="og:site_name" content="FullStackPenguin">
<meta property="og:description" content="參考來源 : https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;IfzY0axpjD8&amp;t&#x3D;333s 基於 LINE Bot 與 OpenAI 的 MySQL 學生成績管理系統教學文件目錄 前言 系統需求與工具 資料庫設計與結構 插入 15 位學生的資料 為每位學生插入成績 使用 OpenAI 生成 SQL 語句 LINE Bot 與 OpenAI 整合 查詢學生成績 常見問">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Flinebot-student.webp?alt=media&token=b991afe3-27a4-4d32-a1d7-5b34b8849a11">
<meta property="article:published_time" content="2024-10-02T08:30:06.000Z">
<meta property="article:modified_time" content="2026-01-28T03:08:27.796Z">
<meta property="article:author" content="全端企鵝">
<meta property="article:tag" content="Line Bot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Flinebot-student.webp?alt=media&token=b991afe3-27a4-4d32-a1d7-5b34b8849a11"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Line Bot 與 Openai & SQL 03 - 成績查詢",
  "url": "https://kingkaizhuang.github.io/2024/10/02/Line-Bot-%E8%88%87-Openai-SQL-%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2/",
  "image": "https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Flinebot-student.webp?alt=media&token=b991afe3-27a4-4d32-a1d7-5b34b8849a11",
  "datePublished": "2024-10-02T08:30:06.000Z",
  "dateModified": "2026-01-28T03:08:27.796Z",
  "author": [
    {
      "@type": "Person",
      "name": "全端企鵝",
      "url": "https://kingkaizhuang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kingkaizhuang.github.io/2024/10/02/Line-Bot-%E8%88%87-Openai-SQL-%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '複製成功',
    error: '複製失敗',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '載入更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Line Bot 與 Openai & SQL 03 - 成績查詢',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/wave.css"><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/themes/blue/pace-theme-flash.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/Avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">35</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Flinebot-student.webp?alt=media&amp;token=b991afe3-27a4-4d32-a1d7-5b34b8849a11);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">FullStackPenguin</span></a><a class="nav-page-title" href="/"><span class="site-name">Line Bot 與 Openai &amp; SQL 03 - 成績查詢</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首頁</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Line Bot 與 Openai &amp; SQL 03 - 成績查詢</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2024-10-02T08:30:06.000Z" title="發表於 2024-10-02 16:30:06">2024-10-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2026-01-28T03:08:27.796Z" title="更新於 2026-01-28 11:08:27">2026-01-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Line-Bot/">Line Bot</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Line-Bot/%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2%E7%B7%B4%E7%BF%92/">成績查詢練習</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">瀏覽量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>參考來源 : <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=IfzY0axpjD8&t=333s">https://www.youtube.com/watch?v=IfzY0axpjD8&amp;t=333s</a></p>
<h2 id="基於-LINE-Bot-與-OpenAI-的-MySQL-學生成績管理系統教學文件"><a href="#基於-LINE-Bot-與-OpenAI-的-MySQL-學生成績管理系統教學文件" class="headerlink" title="基於 LINE Bot 與 OpenAI 的 MySQL 學生成績管理系統教學文件"></a>基於 LINE Bot 與 OpenAI 的 MySQL 學生成績管理系統教學文件</h2><h3 id="目錄"><a href="#目錄" class="headerlink" title="目錄"></a>目錄</h3><ol>
<li>前言</li>
<li>系統需求與工具</li>
<li>資料庫設計與結構</li>
<li>插入 15 位學生的資料</li>
<li>為每位學生插入成績</li>
<li>使用 OpenAI 生成 SQL 語句</li>
<li>LINE Bot 與 OpenAI 整合</li>
<li>查詢學生成績</li>
<li>常見問題與解決方案</li>
<li>結論</li>
</ol>
<hr>
<h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h3><p>本教學文件將指導您如何建立一個基於 MySQL 的學生成績管理系統，並通過 LINE Bot 與 OpenAI 的整合來查詢和管理數據。我們將介紹如何使用 LINE Bot 接收訊息、OpenAI 自動生成 SQL 語句，並通過 MySQL 查詢學生的成績。</p>
<hr>
<h3 id="2-系統需求與工具"><a href="#2-系統需求與工具" class="headerlink" title="2. 系統需求與工具"></a>2. 系統需求與工具</h3><p><strong>系統需求：</strong></p>
<ul>
<li>安裝了 MySQL 伺服器</li>
<li>Python 3 環境（Flask、OpenAI 和 LINE Bot SDK）</li>
<li>MySQL 客戶端或管理工具（如 MySQL Workbench）</li>
<li>OpenAI API 金鑰</li>
<li>LINE Bot API 金鑰</li>
</ul>
<p><strong>工具：</strong></p>
<ul>
<li>MySQL 伺服器</li>
<li>MySQL Workbench 或命令行工具</li>
<li>LINE Bot 設定</li>
<li>OpenAI API 設定</li>
</ul>
<hr>
<h3 id="3-資料庫設計與結構"><a href="#3-資料庫設計與結構" class="headerlink" title="3. 資料庫設計與結構"></a>3. 資料庫設計與結構</h3><p>在本系統中，我們將創建兩個資料表：一個用來存儲學生的基本信息，另一個用來存儲學生的成績。</p>
<h3 id="student-資料表結構："><a href="#student-資料表結構：" class="headerlink" title="student 資料表結構："></a><code>student</code> 資料表結構：</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">    sno <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,     <span class="comment">-- 學號</span></span><br><span class="line">    class <span class="type">VARCHAR</span>(<span class="number">50</span>),       <span class="comment">-- 班級</span></span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>),       <span class="comment">-- 學生姓名</span></span><br><span class="line">    sex <span class="type">VARCHAR</span>(<span class="number">10</span>),         <span class="comment">-- 性別</span></span><br><span class="line">    address <span class="type">VARCHAR</span>(<span class="number">255</span>),    <span class="comment">-- 地址</span></span><br><span class="line">    memo TEXT                <span class="comment">-- 備註</span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="score-資料表結構："><a href="#score-資料表結構：" class="headerlink" title="score 資料表結構："></a><code>score</code> 資料表結構：</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> score (</span><br><span class="line">    sno <span class="type">INT</span>,                 <span class="comment">-- 學號 (外鍵)</span></span><br><span class="line">    class <span class="type">VARCHAR</span>(<span class="number">50</span>),       <span class="comment">-- 班級</span></span><br><span class="line">    subject <span class="type">VARCHAR</span>(<span class="number">100</span>),    <span class="comment">-- 科目</span></span><br><span class="line">    score <span class="type">INT</span>                <span class="comment">-- 成績</span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>這兩個資料表使用 <code>sno</code> 欄位關聯，來管理學生的基本信息和成績。</p>
<hr>
<h3 id="4-插入-15-位學生的資料"><a href="#4-插入-15-位學生的資料" class="headerlink" title="4. 插入 15 位學生的資料"></a>4. 插入 15 位學生的資料</h3><p>接下來，我們將插入 15 位學生的資料：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (sno, class, name, sex, address, memo) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;123 Street A&#x27;</span>, <span class="string">&#x27;Excellent performance&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;Jane Smith&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;456 Street B&#x27;</span>, <span class="string">&#x27;Needs improvement in math&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;Alice Brown&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;789 Street C&#x27;</span>, <span class="string">&#x27;Top student&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;Bob Johnson&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1010 Street D&#x27;</span>, <span class="string">&#x27;New student&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;Charlie Davis&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1111 Street E&#x27;</span>, <span class="string">&#x27;Struggles with homework&#x27;</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;Diana White&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;1212 Street F&#x27;</span>, <span class="string">&#x27;Shows great potential&#x27;</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;Evan Green&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1313 Street G&#x27;</span>, <span class="string">&#x27;Good participation&#x27;</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;Fiona Blue&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;1414 Street H&#x27;</span>, <span class="string">&#x27;Excellent attendance&#x27;</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;George Black&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1515 Street I&#x27;</span>, <span class="string">&#x27;Needs focus on studies&#x27;</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;Hannah Yellow&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;1616 Street J&#x27;</span>, <span class="string">&#x27;Very creative&#x27;</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;Ivan Orange&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1717 Street K&#x27;</span>, <span class="string">&#x27;Great in sports&#x27;</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;Jenny Purple&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;1818 Street L&#x27;</span>, <span class="string">&#x27;Good academic performance&#x27;</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;Kevin Red&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;1919 Street M&#x27;</span>, <span class="string">&#x27;Enthusiastic in class&#x27;</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;Lily Pink&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;2020 Street N&#x27;</span>, <span class="string">&#x27;Hardworking student&#x27;</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;Michael Cyan&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;2121 Street O&#x27;</span>, <span class="string">&#x27;Quick learner&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Fstudent-studens.png?alt=media&token=af046ad4-c41a-4823-88c8-d196058d3f32" alt="student DB"></p>
<h3 id="5-為每位學生插入成績"><a href="#5-為每位學生插入成績" class="headerlink" title="5. 為每位學生插入成績"></a>5. 為每位學生插入成績</h3><p>接下來，我們為每位學生插入 <code>數學</code> 和 <code>國文</code> 的成績：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> score (sno, class, subject, score) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">85</span>),</span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">90</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">78</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">88</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">92</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">95</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">76</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">85</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">82</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">89</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">88</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">91</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">90</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">87</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">85</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">92</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">80</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">90</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">87</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">88</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">89</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">91</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">94</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">96</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">75</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">&#x27;Class 1&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">85</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">88</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">&#x27;Class 2&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">92</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;數學&#x27;</span>, <span class="number">93</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;Class 3&#x27;</span>, <span class="string">&#x27;國文&#x27;</span>, <span class="number">95</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Fstudent-score.png?alt=media&token=745ae4d1-f357-40d7-b972-81c299714061"><img src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Fstudent-score.png?alt=media&token=745ae4d1-f357-40d7-b972-81c299714061" alt="student-score"></a></p>
<hr>
<h3 id="6-使用-OpenAI-生成-SQL-語句"><a href="#6-使用-OpenAI-生成-SQL-語句" class="headerlink" title="6. 使用 OpenAI 生成 SQL 語句"></a>6. 使用 OpenAI 生成 SQL 語句</h3><p>當 LINE Bot 接收到查詢訊息時，會呼叫 OpenAI API 自動生成 SQL 查詢語句。以下是範例的整合程式碼片段：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">response = openai.ChatCompletion.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4o-mini&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant that helps users query a MySQL database.&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: event.message.text&#125;</span><br><span class="line">    ],</span><br><span class="line">    temperature=<span class="number">0</span>,</span><br><span class="line">    max_tokens=<span class="number">400</span>,</span><br><span class="line">    top_p=<span class="number">1</span>,</span><br><span class="line">    frequency_penalty=<span class="number">0</span>,</span><br><span class="line">    presence_penalty=<span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-LINE-Bot-與-OpenAI-整合完整程式碼"><a href="#7-LINE-Bot-與-OpenAI-整合完整程式碼" class="headerlink" title="7. LINE Bot 與 OpenAI 整合完整程式碼"></a>7. LINE Bot 與 OpenAI 整合完整程式碼</h3><p>整合 LINE Bot 與 OpenAI API，並將接收到的查詢請求轉換為 SQL 查詢並從 MySQL 資料庫中提取資料。以下是完整的程式碼片段：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, abort</span><br><span class="line"><span class="keyword">from</span> linebot <span class="keyword">import</span> LineBotApi, WebhookHandler</span><br><span class="line"><span class="keyword">from</span> linebot.exceptions <span class="keyword">import</span> InvalidSignatureError</span><br><span class="line"><span class="keyword">from</span> linebot.models <span class="keyword">import</span> MessageEvent, TextMessage, TextSendMessage</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 設定 Linebot 的 Channel Access Token 和 Channel Secret</span></span><br><span class="line"><span class="comment"># 目前是 鈞皓科技 的 LineBot</span></span><br><span class="line">line_bot_api = LineBotApi(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">handler = WebhookHandler(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 設定 OpenAI API 金鑰</span></span><br><span class="line">openai.api_key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 資料庫連接設定</span></span><br><span class="line">db_settings = &#123;</span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;password&quot;</span>,</span><br><span class="line">    <span class="string">&quot;db&quot;</span>: <span class="string">&quot;studentdb&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/callback&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">callback</span>():</span><br><span class="line">    signature = request.headers[<span class="string">&#x27;X-Line-Signature&#x27;</span>]</span><br><span class="line">    body = request.get_data(as_text=<span class="literal">True</span>)</span><br><span class="line">    app.logger.info(<span class="string">&quot;Request body: &quot;</span> + body)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Request body: &quot;</span> + signature)</span><br><span class="line">        handler.handle(body, signature)</span><br><span class="line">    <span class="keyword">except</span> InvalidSignatureError:</span><br><span class="line">        abort(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;OK&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@handler.add(<span class="params">MessageEvent, message=TextMessage</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_message</span>(<span class="params">event</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 呼叫 OpenAI ChatCompletion API 來生成 SQL 語句</span></span><br><span class="line">        response = openai.ChatCompletion.create(</span><br><span class="line">            model=<span class="string">&quot;gpt-4o-mini&quot;</span>,</span><br><span class="line">            messages=[</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant that helps users query a MySQL database.&quot;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: event.message.text&#125;</span><br><span class="line">            ],</span><br><span class="line">            temperature=<span class="number">0</span>,</span><br><span class="line">            max_tokens=<span class="number">400</span>,</span><br><span class="line">            top_p=<span class="number">1</span>,</span><br><span class="line">            frequency_penalty=<span class="number">0</span>,</span><br><span class="line">            presence_penalty=<span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 處理 OpenAI 回應，過濾掉非 SQL 的部分</span></span><br><span class="line">        response_text = response.choices[<span class="number">0</span>].message[<span class="string">&#x27;content&#x27;</span>].strip()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 使用正則表達式過濾掉註解和解釋部分，只保留 SQL 語句</span></span><br><span class="line">        sql_match = re.search(<span class="string">r&quot;SELECT.*?;&quot;</span>, response_text, re.DOTALL)</span><br><span class="line">        <span class="keyword">if</span> sql_match:</span><br><span class="line">            response_sql = sql_match.group(<span class="number">0</span>).strip()  <span class="comment"># 提取到 SQL 語句</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            response_sql = <span class="string">&quot;&quot;</span>  <span class="comment"># 如果沒有找到有效的 SQL，設為空</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 檢查是否有生成有效的 SQL 語句</span></span><br><span class="line">        <span class="keyword">if</span> response_sql:</span><br><span class="line">            <span class="comment"># 串接資料庫並執行 SQL 查詢</span></span><br><span class="line">            conn = pymysql.connect(**db_settings)</span><br><span class="line">            <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">                command = response_sql.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot; &quot;</span>)  <span class="comment"># 移除多餘的換行符號</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Executing SQL:&quot;</span>, command)</span><br><span class="line">                cursor.execute(command)</span><br><span class="line">                result = cursor.fetchall()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 格式化查詢結果</span></span><br><span class="line">            line_data = <span class="string">&quot;class\tsubject\tscore\n&quot;</span></span><br><span class="line">            line_data += <span class="string">&quot;-------------------\n&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> result:</span><br><span class="line">                line_data += <span class="string">f&quot;<span class="subst">&#123;row[<span class="number">0</span>]&#125;</span>\t<span class="subst">&#123;row[<span class="number">1</span>]&#125;</span>\t<span class="subst">&#123;row[<span class="number">2</span>]&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 回傳結果給 LINE 用戶</span></span><br><span class="line">            line_bot_api.reply_message(event.reply_token, TextSendMessage(text=response_sql + <span class="string">&#x27;\n&#x27;</span> + line_data))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            line_bot_api.reply_message(event.reply_token, TextSendMessage(text=<span class="string">&quot;未能生成有效的 SQL 查詢語句。&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error:&quot;</span>, e)</span><br><span class="line">        line_bot_api.reply_message(event.reply_token, TextSendMessage(text=<span class="string">&quot;發生錯誤，請稍後再試。&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="8-Demo-時間"><a href="#8-Demo-時間" class="headerlink" title="8. Demo 時間"></a>8. Demo 時間</h3><p><a target="_blank" rel="noopener" href="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2F%E6%88%AA%E5%9C%96%202024-10-02%20%E6%99%9A%E4%B8%8A8.14.39.png?alt=media&token=de5ac121-8dc2-4912-be23-0ac4a82635ca"><img src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2F%E6%88%AA%E5%9C%96%202024-10-02%20%E6%99%9A%E4%B8%8A8.14.39.png?alt=media&token=de5ac121-8dc2-4912-be23-0ac4a82635ca" alt="linebot-demo"></a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://kingkaizhuang.github.io">全端企鵝</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章連結: </span><span class="post-copyright-info"><a href="https://kingkaizhuang.github.io/2024/10/02/Line-Bot-%E8%88%87-Openai-SQL-%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2/">https://kingkaizhuang.github.io/2024/10/02/Line-Bot-%E8%88%87-Openai-SQL-%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版權聲明: </span><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 授權協議。轉載請註明來源 <a href="https://kingkaizhuang.github.io" target="_blank">FullStackPenguin</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Line-Bot/">Line Bot</a></div><div class="post-share"><div class="social-share" data-image="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Fstudent-score%2Flinebot-student.webp?alt=media&amp;token=b991afe3-27a4-4d32-a1d7-5b34b8849a11" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/10/24/Django-WebSocket/" title="Django WebSocket 前後端即時通訊"><img class="cover" src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FDjango%2Fwebsocket.webp?alt=media&amp;token=7e9597ac-6eb5-480c-b7ae-862eede0f1ab" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Django WebSocket 前後端即時通訊</div></div><div class="info-2"><div class="info-item-1">全部步驟總結 安裝必要的套件： 1pip install channels channels_redis   channels：使 Django 支持 WebSocket。 channels_redis：用來實現 Channel Layer，讓不同的 WebSocket 連接能夠進行通訊。   設定 Django 專案：  在 settings.py 中添加 Channels 和 Channel Layer 配置：  12345678910111213141516INSTALLED_APPS = [    # 其他已安裝的應用    &#x27;channels&#x27;,    &#x27;chat&#x27;,  # 你的 WebSocket 應用]ASGI_APPLICATION = &#x27;classify.asgi.application&#x27;CHANNEL_LAYERS = &#123;    &#x27;default&#x27;: &#123;        &#x27;BACKEND&#x27;: &#x27;channels_redis.core....</div></div></div></a><a class="pagination-related" href="/2024/10/01/Mac-Django-%E5%BB%BA%E7%BD%AE%E7%92%B0%E5%A2%83/" title="Mac Django 建置環境"><img class="cover" src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FDjango%2Fdjango%20logo.jpeg?alt=media&amp;token=8bc6ff88-240d-4df6-af8f-3e33bf72140f" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Mac Django 建置環境</div></div><div class="info-2"><div class="info-item-1">macOS 上下載並安裝 Django 教學指南（不使用虛擬環境，並加入 PATH 教學）步驟 1：確認安裝 Homebrew（可選）如果你還沒有安裝 Homebrew，可以按照以下指令來安裝。Homebrew 是 macOS 上的包管理器，方便你安裝和管理軟件：  打開「終端機」(Terminal)，輸入以下指令來安裝 Homebrew：1/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot; 等待 Homebrew 安裝完成，然後更新 Homebrew：1brew update  步驟 2：安裝 Python 3 確認是否已安裝 Python 3：1python3 --version 如果沒有安裝或版本過舊，可以使用 Homebrew 安裝最新的 Python 3：1brew install python3  步驟 3：安裝 Django 確保 Python 3 已經安裝，然後使用 pip3 安裝 Django： 1pip...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相關推薦</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/09/19/Line-Bot%E8%88%87Chatgpt%E6%87%89%E7%94%A8-%E5%BB%BA%E7%AB%8B%E6%A9%9F%E5%99%A8%E4%BA%BA%E5%B8%B3%E8%99%9F/" title="Line Bot 與 Chatgpt應用 01 - 建立帳號"><img class="cover" src="/images/Line-Bot/create-account/create-account2.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-19</div><div class="info-item-2">Line Bot 與 Chatgpt應用 01 - 建立帳號</div></div><div class="info-2"><div class="info-item-1">Line Bot 建立流程我們將一步一步指導你如何建立一個新的 Line Bot 帳戶，並完成基本設定。 1. 進入 Line Business 頁面首先，前往 Line Business 官方網站，這是 Line Bot 開發者專用的後台管理平台。  2. 登入並進入 Console在頁面的右上角，找到並點擊 Console 按鈕，進入 Line Bot 後台控制台。  3. 進入後台控制台系統會將你引導至後台管理畫面，在這裡可以管理和創建你的 Line Bot 專案。  4. 選擇 Providers在控制台頁面中，找到並點擊 Providers，我都想成這是用來管理多個專案的文件資料夾。  5. 創建新的 Provider輸入一個你定義的 Provider 名稱。  6. 創建 Message API Channel選擇你剛剛創建的 Provider，接著在頁面中間位置找到並點擊 Create a Message API channel，以創建一個 Message API 機器人來管理訊息傳遞。  7. 創建 Line Official Account系統會引導你創建一個 ...</div></div></div></a><a class="pagination-related" href="/2024/09/26/Line-Bot%E8%88%87Chatgpt%E6%87%89%E7%94%A8-%E4%B8%B2%E6%8E%A5replit%E5%A4%A7%E7%A5%9E%E7%A8%8B%E5%BC%8F/" title="Line Bot 與 Chatgpt應用 02 - 執行程式"><img class="cover" src="https://firebasestorage.googleapis.com/v0/b/zhuang-afef4.appspot.com/o/KingKaiZhuang.github.io%2FLine-Bot%E5%92%8Cgpt%E5%AF%A6%E6%88%B0%E6%95%99%E5%AD%B8%2Freplit-python%2Fbanner.webp?alt=media&token=04b3ef21-5ea8-4c0d-9a96-318f3eeb974a" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-26</div><div class="info-item-2">Line Bot 與 Chatgpt應用 02 - 執行程式</div></div><div class="info-2"><div class="info-item-1">Line Bot 和 GPT 實戰教學本教學將帶領你使用 Replit 平台運行由 GPT 支援的 Line Bot，並逐步指導你如何設定和執行這個 Python 程式碼。 步驟 1: 進入 Replit 並複製專案首先，進入 Replit 上的大神已經寫好的 Python 程式碼頁面。  點擊以下連結，進入 Replit 上的專案頁面並進行複製 (fork) 到你自己的工作區： GPTDev_LINE_bot - Replit 步驟 2: 複製專案到自己的工作區點擊 “Fork” 按鈕將專案複製到你的 Replit 帳戶中：  步驟 3: 設定環境變數在 Replit 的專案設定中，輸入以下三個環境變數：  LINE_SECRET：你在 Line 開發者後台取得的 Secret LINE_TOKEN：你在 Line 開發者後台取得的 Token OPENAI_API_KEY：你從 OpenAI 取得的 API Key  如圖所示：   提示: 如果你不知道如何取得這三個值，請私訊我以獲得幫助。  步驟 4: 執行專案設定好環境變數後，點擊 “Run” 按鈕來執行程式。  完成恭...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/Avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">全端企鵝</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">35</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KingKaiZhuang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://www.instagram.com/zhuang_2024/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #E4405F;"></i></a><a class="social-icon" href="https://line.me/ti/p/EeWpQ7ef-e" target="_blank" title="LINE"><i class="fab fa-line" style="color: #00C300;"></i></a><a class="social-icon" href="https://www.facebook.com/profile.php?id=100002212333597" target="_blank" title="Facebook"><i class="fab fa-facebook" style="color: #4267B2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><a target="_blank" rel="noopener" href="https://orca-biz.com/" alt="OrcaBiz 虎鯨數位行銷" >OrcaBiz 實習生</a>
<p>🏫 STUST</p>
<p>📖 目前正在準備 <strong>CPE</strong> 和 <strong>英文多益</strong>。</p>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%96%BC-LINE-Bot-%E8%88%87-OpenAI-%E7%9A%84-MySQL-%E5%AD%B8%E7%94%9F%E6%88%90%E7%B8%BE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%B5%B1%E6%95%99%E5%AD%B8%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">基於 LINE Bot 與 OpenAI 的 MySQL 學生成績管理系統教學文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E9%8C%84"><span class="toc-number">1.1.</span> <span class="toc-text">目錄</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%89%8D%E8%A8%80"><span class="toc-number">1.2.</span> <span class="toc-text">1. 前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B3%BB%E7%B5%B1%E9%9C%80%E6%B1%82%E8%88%87%E5%B7%A5%E5%85%B7"><span class="toc-number">1.3.</span> <span class="toc-text">2. 系統需求與工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%B3%87%E6%96%99%E5%BA%AB%E8%A8%AD%E8%A8%88%E8%88%87%E7%B5%90%E6%A7%8B"><span class="toc-number">1.4.</span> <span class="toc-text">3. 資料庫設計與結構</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#student-%E8%B3%87%E6%96%99%E8%A1%A8%E7%B5%90%E6%A7%8B%EF%BC%9A"><span class="toc-number">1.5.</span> <span class="toc-text">student 資料表結構：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#score-%E8%B3%87%E6%96%99%E8%A1%A8%E7%B5%90%E6%A7%8B%EF%BC%9A"><span class="toc-number">1.6.</span> <span class="toc-text">score 資料表結構：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8F%92%E5%85%A5-15-%E4%BD%8D%E5%AD%B8%E7%94%9F%E7%9A%84%E8%B3%87%E6%96%99"><span class="toc-number">1.7.</span> <span class="toc-text">4. 插入 15 位學生的資料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%82%BA%E6%AF%8F%E4%BD%8D%E5%AD%B8%E7%94%9F%E6%8F%92%E5%85%A5%E6%88%90%E7%B8%BE"><span class="toc-number">1.8.</span> <span class="toc-text">5. 為每位學生插入成績</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8-OpenAI-%E7%94%9F%E6%88%90-SQL-%E8%AA%9E%E5%8F%A5"><span class="toc-number">1.9.</span> <span class="toc-text">6. 使用 OpenAI 生成 SQL 語句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-LINE-Bot-%E8%88%87-OpenAI-%E6%95%B4%E5%90%88%E5%AE%8C%E6%95%B4%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="toc-number">1.10.</span> <span class="toc-text">7. LINE Bot 與 OpenAI 整合完整程式碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Demo-%E6%99%82%E9%96%93"><span class="toc-number">1.11.</span> <span class="toc-text">8. Demo 時間</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/04/unity-scene-data/" title="Unity 場景切換以及 Data 共享"><img src="/images/unity-data-scene.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity 場景切換以及 Data 共享"/></a><div class="content"><a class="title" href="/2025/12/04/unity-scene-data/" title="Unity 場景切換以及 Data 共享">Unity 場景切換以及 Data 共享</a><time datetime="2025-12-03T16:00:00.000Z" title="發表於 2025-12-04 00:00:00">2025-12-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/streamlit-yolo/" title="Streamlit 結合 yolo 辨識圖片"><img src="/images/streamlit_yolo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Streamlit 結合 yolo 辨識圖片"/></a><div class="content"><a class="title" href="/2025/12/01/streamlit-yolo/" title="Streamlit 結合 yolo 辨識圖片">Streamlit 結合 yolo 辨識圖片</a><time datetime="2025-11-30T16:00:00.000Z" title="發表於 2025-12-01 00:00:00">2025-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/26/next-js-v16-base/" title="Next.js v16 基本常識"><img src="/images/Gemini_Generated_Image_8zuhop8zuhop8zuh-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Next.js v16 基本常識"/></a><div class="content"><a class="title" href="/2025/11/26/next-js-v16-base/" title="Next.js v16 基本常識">Next.js v16 基本常識</a><time datetime="2025-11-25T16:00:00.000Z" title="發表於 2025-11-26 00:00:00">2025-11-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/24/interest-and-yield/" title="利率＆殖利率"><img src="/images/image-12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利率＆殖利率"/></a><div class="content"><a class="title" href="/2025/11/24/interest-and-yield/" title="利率＆殖利率">利率＆殖利率</a><time datetime="2025-11-23T16:00:00.000Z" title="發表於 2025-11-24 00:00:00">2025-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/15/wp-restore-local/" title="如何用雲端備份在本地 Local 重建 WordPress"><img src="/images/Gemini_Generated_Image_vfctf8vfctf8vfct.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何用雲端備份在本地 Local 重建 WordPress"/></a><div class="content"><a class="title" href="/2025/11/15/wp-restore-local/" title="如何用雲端備份在本地 Local 重建 WordPress">如何用雲端備份在本地 Local 重建 WordPress</a><time datetime="2025-11-14T16:00:00.000Z" title="發表於 2025-11-15 00:00:00">2025-11-15</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2024 - 2026 By 全端企鵝</span></div><div class="footer_custom_text">StackPenguin | STUST</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const abcjsInit = () => {
    const abcjsFn = () => {
      setTimeout(() => {
        const sheets = document.querySelectorAll(".abc-music-sheet")
        for (let i = 0; i < sheets.length; i++) {
          const ele = sheets[i]
          if (ele.children.length > 0) continue

          // Parse parameters from data-params attribute
          let params = {}
          const dp = ele.getAttribute("data-params")
          if (dp) {
            try {
              params = JSON.parse(dp)
            } catch (e) {
              console.error("Failed to parse data-params:", e)
            }
          }

          // Merge parsed parameters with the responsive option
          // Ensures params content appears before responsive
          const options = { ...params, responsive: "resize" }

          // Render the music score using ABCJS.renderAbc
          ABCJS.renderAbc(ele, ele.textContent, options)
        }
      }, 100)
    }

    if (typeof ABCJS === "object") {
      abcjsFn()
    } else {
      btf.getScript("https://cdn.jsdelivr.net/npm/abcjs@6.6.0/dist/abcjs-basic-min.min.js").then(abcjsFn)
    }
  }

  if (window.pjax) {
    abcjsInit()
  } else {
    window.addEventListener("load", abcjsInit)
  }

  btf.addGlobalFn("encrypt", abcjsInit, "abcjs")
})()</script></div><div class="aplayer no-destroy"  data-id="60198" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>